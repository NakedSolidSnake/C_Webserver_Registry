<!DOCTYPE html>
<html>

<head>
    <meta charset="uft-8">    
    <title>Add new registry</title>
    <style>
        div{
   
    
        }

        label {
            display: inline-block;
            width: 140px;
            text-align: right;
        }â€‹

        button{
            margin: 0 auto;
            display: inline-block; 
        }

        .button-center{
            display: flex;
            justify-content: center;
            align-items: center;
            height: auto;
        }
    </style>
    <script>

        var id;

        class Person {
            name;
            address;
            age;
        }

        function getPersonFromStorage(person){
            // Check browser support
            if (typeof(Storage) !== "undefined") {
            // Retrieve
                person.id = localStorage.getItem("id");
                person.name = localStorage.getItem("name");
                person.address = localStorage.getItem("address");
                person.age = localStorage.getItem("age");
                id = person.id;
                return person;
            } else {
                alert("Browser does not support Web Storage.");
                return null;
            }
        }

        function setPersonFill(person){
            document.getElementById("fname").value = person.name;
            document.getElementById("faddress").value = person.address;
            document.getElementById("fage").value = person.age;
        }

        function getPersonFromScreen(person) {
            person.name = document.getElementById("fname").value;
            document.getElementById("fname").value = "";

            person.address = document.getElementById("faddress").value;
            document.getElementById("faddress").value = "";

            person.age = document.getElementById("fage").value;
            document.getElementById("fage").value = "";
        }

        function getStorageData(){
            person = new Person();
            getPersonFromStorage(person);
            setPersonFill(person);
        }

        function httpSendData() {

            person = new Person();
            getPersonFromScreen(person);            

            var xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = function () {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200){
                    window.location.replace('/');
                }
            }

            xmlHttp.open("POST", "/update", true); // true for asynchronous 
            xmlHttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xmlHttp.send("id=" + id +"&fname="+ person.name.replace(/\s/g, '+') +"&faddress="+ person.address.replace(/\s/g, '+') + "&fage=" + person.age);
        }


    </script>

</head>

<body onload="getStorageData()">
    <div>
        <div>
            <label for="fname">Name:</label>
            <input type="text" id="fname" name="fname" required placeholder="Enter a name">
        </div>

        <div>
            <label for="faddress">Address:</label>
            <input type="text" id="faddress" name="faddress" required placeholder="Enter an address">
        </div>

        <div>
            <label for="fage">Age:</label>
            <input type="number" id="fage" name="fage" min="0" max="100" required>
        </div>

        <div class="button-center">
            <button onclick="httpSendData()">Update</button>
            <!-- <button onclick="httpGetAsync()" >Cancel</button> -->
            
        </div>
    </div>
</body>
<footer>

</footer>

</html>